# TM Setter 요구사항

## 1. 개요
TM Setter는 사용자 인증을 통해 데이터베이스 코드를 선택하고, Jira 이슈를 관리하는 애플리케이션입니다.
- **GUI 버전**: PyQt5 기반 데스크톱 애플리케이션
- **CLI 버전**: 터미널 기반 대화형 명령줄 도구

## 2. CLI 버전 기능 요구사항

### 2.1 사용자 인증
- **명령어**: `tm-setter login` 또는 대화형 모드
- **입력 방식**:
  - 대화형: ID와 Password를 순차적으로 입력
  - 명령줄 옵션: `--id <ID>` (비밀번호는 보안상 대화형으로만)
- **동작**:
  - ID/PW 유효성 검증
  - 인증 성공 시 토큰을 로컬에 저장
  - 인증 실패 시 에러 메시지 표시 후 재시도 프롬프트

### 2.2 DB Code 선택
- **명령어**: `tm-setter select-db` 또는 대화형 모드
- **입력 방식**:
  - 대화형: 각 항목을 단계별로 선택
    - 첫 번째 항목: 번호 선택 또는 검색
    - 두 번째 항목: 번호 선택 또는 검색
    - 세 번째 항목: 번호 선택 또는 검색
  - 명령줄 옵션: `--db1 <value> --db2 <value> --db3 <value>`
- **동작**:
  - 각 단계에서 사용 가능한 옵션 목록 표시
  - 검색 기능 제공 (부분 일치)
  - 선택 완료 후 다음 단계로 진행

### 2.3 Jira Issue 선택
- **명령어**: `tm-setter select-issue` 또는 대화형 모드
- **입력 방식**:
  - 대화형: 
    - Issue 목록 페이지네이션 표시
    - 번호 선택 또는 키워드 검색
  - 명령줄 옵션: `--issue <ISSUE-KEY>`
- **동작**:
  - DB Code 기반 Issue 필터링
  - 테이블 형식으로 Issue 목록 표시 (Key, Summary, Status)
  - 검색 및 필터링 기능

### 2.4 옵션 설정
- **명령어**: `tm-setter configure` 또는 대화형 모드
- **입력 방식**:
  - 대화형:
    - Repository Name 입력/선택
    - 바이너리 SW 버전 선택
    - 건너뛰기 옵션 (Enter 키)
  - 명령줄 옵션: `--repo <name> --version <version>`
- **동작**:
  - 선택적 설정 (건너뛸 수 있음)
  - 설정 완료 후 작업 실행

### 2.5 통합 실행 모드
- **명령어**: `tm-setter` 또는 `tm-setter interactive`
- **동작**: 
  - 모든 단계를 순차적으로 진행
  - 각 단계에서 진행 상황 표시 (Step 1/4, Step 2/4 등)
  - 이전 단계로 돌아가기 옵션 제공

## 3. GUI 버전 기능 요구사항 (기존)

### 3.1 사용자 인증
- **화면**: 로그인 화면
- **입력 필드**:
  - ID 입력 필드
  - Password 입력 필드
  - 로그인 버튼
- **동작**:
  - ID/PW 유효성 검증
  - 인증 성공 시 DB Code 선택 화면으로 이동
  - 인증 실패 시 에러 메시지 표시

### 3.2 DB Code 선택
- **화면**: DB Code 선택 화면
- **구성 요소**:
  - 첫 번째 항목 선택 (드롭다운 또는 리스트)
  - 두 번째 항목 선택 (드롭다운 또는 리스트)
  - 세 번째 항목 선택 (드롭다운 또는 리스트)
  - 다음 버튼
  - 이전 버튼 (로그인 화면으로)
- **동작**:
  - 각 항목별 후보 리스트 표시
  - 세 항목 모두 선택 후 다음 버튼 활성화
  - 다음 버튼 클릭 시 Jira Issue 선택 화면으로 이동

### 3.3 Jira Issue 선택
- **화면**: Jira Issue 선택 화면
- **구성 요소**:
  - Issue 리스트 (Key/Summary 표시)
  - 검색 필드 (선택사항)
  - 선택 버튼
  - 이전 버튼 (DB Code 선택 화면으로)
- **동작**:
  - DB Code 기반으로 Issue 목록 필터링
  - Issue 선택 후 다음 화면으로 이동

### 3.4 옵션 설정 (선택사항)
- **화면**: 옵션 설정 화면
- **구성 요소**:
  - Repository Name 입력/선택 필드
  - 바이너리 SW 버전 선택 필드
  - 완료 버튼
  - 건너뛰기 버튼
  - 이전 버튼 (Jira Issue 선택 화면으로)
- **동작**:
  - 옵션 값 설정 (필수 아님)
  - 완료 또는 건너뛰기 시 작업 실행

## 4. 비기능 요구사항

### 4.1 성능
- **비동기 처리**: 모든 네트워크 요청 및 무거운 작업은 비동기로 처리
- **UI 응답성**: 
  - GUI: 작업 진행 중에도 UI가 반응해야 함
  - CLI: 긴 작업 중 진행 표시 (spinner, progress bar)
- **로딩 표시**: 긴 작업 수행 시 진행 상황 표시

### 4.2 사용성
- **직관적 인터페이스**: 
  - GUI: 사용자가 쉽게 이해할 수 있는 UI
  - CLI: 명확한 프롬프트와 도움말 메시지
- **에러 처리**: 명확한 에러 메시지 제공
- **진행 상황 표시**: 현재 단계 표시 (예: Step 1/4)

### 4.3 보안
- **비밀번호 마스킹**: 
  - GUI: 패스워드 입력 필드 마스킹
  - CLI: getpass 모듈 사용하여 입력 숨김
- **세션 관리**: 로그인 상태 유지 및 타임아웃 처리
- **토큰 저장**: 안전한 로컬 저장소 사용

### 4.4 호환성
- **크로스 플랫폼**: Windows, macOS, Linux 지원
- **Python 버전**: Python 3.8 이상 지원
- **터미널 호환성**: 
  - ANSI 색상 코드 지원
  - UTF-8 인코딩 지원

## 5. 기술 요구사항

### 5.1 GUI 버전
- **프레임워크**: PyQt5
- **비동기 처리**: QThread 사용
- **스타일링**: QSS (Qt Style Sheets)

### 5.2 CLI 버전
- **명령줄 파싱**: argparse 또는 click
- **대화형 입력**: prompt_toolkit 또는 inquirer
- **테이블 출력**: rich 또는 tabulate
- **진행 표시**: tqdm 또는 rich.progress
- **색상 출력**: colorama 또는 rich

### 5.3 공통
- **API 통신**: requests 라이브러리
- **설정 관리**: JSON 파일 (configparser 또는 pydantic)
- **로깅**: Python logging 모듈
- **인증 토큰**: keyring 라이브러리 (안전한 저장)

## 6. CLI 사용 예시

### 6.1 대화형 모드
```bash
$ tm-setter
Welcome to TM Setter CLI v1.0.0

[Step 1/4] User Authentication
Username: john.doe
Password: ****

✓ Login successful!

[Step 2/4] Select DB Code
Select first item:
1. Database A
2. Database B
3. Database C
Enter number or search term: 2

Select second item:
1. Schema X
2. Schema Y
Enter number or search term: 1

Select third item:
1. Table Alpha
2. Table Beta
3. Table Gamma
Enter number or search term: 3

[Step 3/4] Select Jira Issue
┌──────────┬────────────────────────────┬──────────┐
│ Key      │ Summary                    │ Status   │
├──────────┼────────────────────────────┼──────────┤
│ PROJ-123 │ Implement new feature      │ Open     │
│ PROJ-124 │ Fix database connection    │ In Progress │
│ PROJ-125 │ Update documentation       │ Todo     │
└──────────┴────────────────────────────┴──────────┘

Enter issue number or key: 2

[Step 4/4] Configuration (Optional)
Repository name (press Enter to skip): my-repo
Binary SW version (press Enter to skip): v2.1.0

✓ Configuration complete!
Processing...
✓ Task completed successfully!
```

### 6.2 명령줄 옵션 모드
```bash
# 로그인
$ tm-setter login --id john.doe
Password: ****

# DB 선택
$ tm-setter select-db --db1 "Database B" --db2 "Schema X" --db3 "Table Gamma"

# Issue 선택
$ tm-setter select-issue --issue PROJ-124

# 옵션 설정
$ tm-setter configure --repo my-repo --version v2.1.0
```

## 7. 흐름도
```
CLI 시작
   │
   ├─→ 대화형 모드 ──→ 로그인 → DB 선택 → Issue 선택 → 옵션 → 완료
   │                      ↑         ↓          ↓           ↓
   │                      └─────────┴──────────┴───────────┘
   │                           (이전 단계로 이동 가능)
   │
   └─→ 명령줄 모드 ──→ 개별 명령 실행 → 완료
```